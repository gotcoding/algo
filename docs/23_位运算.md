# 位运算

位运算就是直接对整数在内存中的二进制位进行操作，不需要转成十进制，因此处理速度非常快。

## 各种位运算的使用

### & and运算
and运算通常用于二进制`取位`操作，例如一个数 and 1的结果就是取二进制的最末位。这可以用来判断一个整数的奇偶，二进制的最末位为0表示该数为偶数，最末位为1表示该数为奇数.

### | or运算
or运算通常用于二进制特定位上的无条件赋值，例如一个数or 1的结果就是把二进制最末位强行变成1。如果需要把二进制最末位变成0，对这个数or 1之后再减一就可以了，其实际意义就是把这个数强行变成最接近的偶数。

### ^ xor运算
xor运算通常用于对二进制的特定一位进行取反操作，因为异或可以这样定义：0和1异或0都不变，异或1则取反。异或遵守交换律和乘法律：a^b = b^a; (a^b)^c = a^(b^c)。两个数交换：
```go
    a = a ^ b;
    b = a ^ b;
    a = a ^ b;
```
### ! not运算
not运算的定义是把内存中的0和1全部取反。使用not运算时要格外小心，你需要注意整数类型有没有符号。

### << 进位运算
a << b表示二进制右移b位（去掉末b位），相当于a除以2的b次方（取整）。

### >> 退位运算
 a << b就表示把a转为二进制后左移b位（在后面添b个0）。实际上就是a乘以2的b次方，因为在二进制数后添一个0就相当于该数乘以2。

## 常用的位运算变换操作
 下面列举了一些常见的二进制位的变换操作。

  | 功能                  | 示例                   | 位运算                  |
  | --------------------- | ---------------------- | ----------------------- |
  | 去掉最后一位          | (101101->10110)        | x >> 1                  |
  | 在最后加一个0         | (101101->1011010)      | x << 1                  |
  | 在最后加一个1         | (101101->1011011)      | x << 1 + 1              |
  | 把最后一位变成1       | (101100->101101)       | `x | 1`                |
  | 把最后一位变成0       | (101101->101100)       | `x | 1 - 1`              |
  | 最后一位取反          | (101101->101100)       | x ^ 1                 |
  | 把右数第k位变成1      | (101001->101101,k=3)   | `x | (1 << (k-1))`      |
  | 把右数第k位变成0      | (101101->101001,k=3)   | x & not (1 << (k-1)) |
  | 右数第k位取反         | (101001->101101,k=3)   | x ^ (1 << (k-1))     |
  | 取末三位              | (1101101->101)         | x & 7                 |
  | 取末k位               | (1101101->1101,k=5)    | x & (1 << k-1)       |
  | 取右数第k位           | (1101101->1,k=4)       | x >> (k-1) & 1       |
  | 把末k位变成1          | (101001->101111,k=4)   | `x | (1 << k-1)`        |
  | 末k位取反             | (101001->100110,k=4)   | x ^ (1 << k-1)       |
  | 把右边连续的1变成0    | (100101111->100100000) | x & (x+1)             |
  | 把右起第一个0变成1    | (100101111->100111111) | `x | (x+1) `             |
  | 把右边连续的0变成1    | (11011000->11011111)   | `x | (x-1)  `            |
  | 取右边连续的1         | (100101111->1111)      | (x ^ (x+1)) >> 1     |
  | 去掉右起第一个1的左边 | (100101000->1000)      | x & (x ^ (x-1))     |